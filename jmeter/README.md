# JMeter Load Testing –¥–ª—è IS Lab1 API

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Apache JMeter –¥–ª—è REST API —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- `API-Load-Test.jmx` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ—Å—Ç-–ø–ª–∞–Ω —Å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏

## üéØ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 1. **Flats API - Load Test** (50 –ø–æ—Ç–æ–∫–æ–≤, 10 –∏—Ç–µ—Ä–∞—Ü–∏–π)
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–≤–∞—Ä—Ç–∏—Ä –ø—Ä–∏ —Å—Ä–µ–¥–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–µ:
- ‚úÖ `GET /flats` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- ‚úÖ `POST /flats` - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã
- ‚úÖ `GET /flats/search/cheapest-with-balcony` - –ø–æ–∏—Å–∫ —Å–∞–º–æ–π –¥–µ—à–µ–≤–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã —Å –±–∞–ª–∫–æ–Ω–æ–º

### 2. **Import API - Stress Test** (20 –ø–æ—Ç–æ–∫–æ–≤, 5 –∏—Ç–µ—Ä–∞—Ü–∏–π)
–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–æ–≤–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞:
- ‚úÖ `POST /import` - –º–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Apache JMeter**
   ```bash
   # macOS (—á–µ—Ä–µ–∑ Homebrew)
   brew install jmeter
   
   # –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞
   # https://jmeter.apache.org/download_jmeter.cgi
   ```

2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API
   curl http://localhost:28600/is-lab1/api/flats
   ```

### –ó–∞–ø—É—Å–∫ –≤ GUI —Ä–µ–∂–∏–º–µ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
cd jmeter
jmeter -t API-Load-Test.jmx
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å:
```bash
jmeter -t /Users/arekalov/Yandex.Disk.localized/Itmo/5/IS/lab1/is-lab1/jmeter/API-Load-Test.jmx
```

### –ó–∞–ø—É—Å–∫ –≤ CLI —Ä–µ–∂–∏–º–µ (–¥–ª—è production —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
cd jmeter

# –ó–∞–ø—É—Å–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
jmeter -n -t API-Load-Test.jmx \
  -l results/test-results.jtl \
  -e -o results/html-report

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
# -n : non-GUI —Ä–µ–∂–∏–º
# -t : –ø—É—Ç—å –∫ —Ç–µ—Å—Ç-–ø–ª–∞–Ω—É
# -l : —Ñ–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
# -e : –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å HTML –æ—Ç—á–µ—Ç
# -o : –ø–∞–ø–∫–∞ –¥–ª—è HTML –æ—Ç—á–µ—Ç–∞
```

### –ó–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```bash
# –ò–∑–º–µ–Ω–∏—Ç—å —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç
jmeter -n -t API-Load-Test.jmx \
  -JBASE_URL=192.168.1.100 \
  -JPORT=8080 \
  -l results/test-results.jtl

# –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø—ã
jmeter -n -t API-Load-Test.jmx \
  -JnumThreads=100 \
  -l results/test-results.jtl
```

## üìä –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –í GUI —Ä–µ–∂–∏–º–µ

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞ –≤ JMeter GUI –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ç—Ä–∏ —Ç–∏–ø–∞ –æ—Ç—á–µ—Ç–æ–≤:

1. **View Results Tree** - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
   - HTTP –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
   - –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
   - –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞
   - –ó–∞–≥–æ–ª–æ–≤–∫–∏

2. **Summary Report** - —Å–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
   - –ú–∏–Ω–∏–º—É–º/–ú–∞–∫—Å–∏–º—É–º
   - Throughput (–∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫)
   - Error %

3. **Graph Results** - –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
   - –ì—Ä–∞—Ñ–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
   - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
   - –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

### –í CLI —Ä–µ–∂–∏–º–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –æ—Ç–∫—Ä–æ–π—Ç–µ HTML –æ—Ç—á–µ—Ç:

```bash
open results/html-report/index.html
# –ò–ª–∏
firefox results/html-report/index.html
```

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –æ—Ç—á–µ—Ç–µ:**
- **Response Time Percentiles** - 90th, 95th, 99th –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏
- **Throughput** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- **Error Rate** - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
- **Apdex** - Application Performance Index (—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–µ—Å—Ç–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏

–û—Ç–∫—Ä–æ–π—Ç–µ `API-Load-Test.jmx` –≤ JMeter GUI –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Thread Group:

**–î–ª—è Thread Group "Flats API - Load Test":**
- **Number of Threads (users)**: 50 ‚Üí –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Ramp-up Period**: 10 —Å–µ–∫—É–Ω–¥ ‚Üí –≤—Ä–µ–º—è —Ä–∞–∑–≥–æ–Ω–∞ –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- **Loop Count**: 10 ‚Üí –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

**–°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **–õ–µ–≥–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏):
   - Threads: 10
   - Ramp-up: 5s
   - Loops: 5

2. **–°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞** (—Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏):
   - Threads: 50
   - Ramp-up: 10s
   - Loops: 10

3. **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** (—Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç):
   - Threads: 200
   - Ramp-up: 30s
   - Loops: 20

4. **Spike —Ç–µ—Å—Ç** (—Ä–µ–∑–∫–∏–π —Å–∫–∞—á–æ–∫):
   - Threads: 500
   - Ramp-up: 5s
   - Loops: 5

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

–í —Ä–∞–∑–¥–µ–ª–µ **User Defined Variables** (Test Plan):
- `BASE_URL` - —Ö–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: localhost)
- `PORT` - –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 28600)
- `API_PATH` - –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: /is-lab1/api)

## üìà –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
jmeter -t API-Load-Test.jmx
```

### 2. –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –≤ 4 —Ä–∞–∑–∞
jmeter -n -t API-Load-Test.jmx \
  -l results/stress-test.jtl \
  -e -o results/stress-report
```

### 3. –î–ª–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Endurance Test)

–ò–∑–º–µ–Ω–∏—Ç–µ –≤ GUI:
- Thread Group ‚Üí Scheduler ‚Üí ‚úÖ Enable
- Duration: 3600 (1 —á–∞—Å)
- Startup delay: 0

```bash
jmeter -n -t API-Load-Test-Endurance.jmx \
  -l results/endurance-test.jtl \
  -e -o results/endurance-report
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
jmeter -n -t API-Load-Test.jmx \
  -JBASE_URL=helios.cs.ifmo.ru \
  -JPORT=28600 \
  -l results/remote-test.jtl
```

## üéì –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –•–æ—Ä–æ—à–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- ‚úÖ Error rate < 1%
- ‚úÖ Average response time < 500ms
- ‚úÖ 95th percentile < 1000ms
- ‚úÖ Throughput —Å—Ç–∞–±–∏–ª—å–Ω—ã–π

### –ü—Ä–æ–±–ª–µ–º—ã:
- ‚ùå Error rate > 5% ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ùå Response time > 3s ‚Üí –º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚ùå –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ ‚Üí —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏–ª–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è
- ‚ùå Timeout –æ—à–∏–±–∫–∏ ‚Üí –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞

## üìù –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–£–≤–µ–ª–∏—á—å—Ç–µ connection pool** –≤ WildFly
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–î–æ–±–∞–≤—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã** –≤ –ë–î –¥–ª—è –ø–æ–ª–µ–π –ø–æ–∏—Å–∫–∞
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pagination** –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ JVM** (heap memory, GC)

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Apache JMeter Documentation](https://jmeter.apache.org/usermanual/index.html)
- [Best Practices](https://jmeter.apache.org/usermanual/best-practices.html)
- [JMeter Functions](https://jmeter.apache.org/usermanual/functions.html)

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å —Ç–µ—Å—Ç–∞–º–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞: `curl http://localhost:28600/is-lab1/api/flats`
2. –õ–æ–≥–∏ WildFly: `tail -f $WILDFLY_HOME/standalone/log/server.log`
3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ connection pool –≤ WildFly

---

**–£—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! üöÄ**

